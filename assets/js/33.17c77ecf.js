(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{328:function(e,t,l){"use strict";l.r(t);var n=l(4),v=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"滚动加载更多"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#滚动加载更多"}},[e._v("#")]),e._v(" 滚动加载更多")]),e._v(" "),t("p",[e._v('import { ref, onActivated, onDeactivated } from "vue"')]),e._v(" "),t("p",[e._v("export default function () {")]),e._v(" "),t("p",[e._v("let element = null")]),e._v(" "),t("p",[e._v("const isBottom = ref(false)")]),e._v(" "),t("p",[e._v("const scrollListenerHandler = () => {")]),e._v(" "),t("p",[e._v("element = element || document.getElementById('content')")]),e._v(" "),t("p",[e._v("if (!element) {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("return\n")])])]),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("const { clientHeight, scrollTop, scrollHeight } = element")]),e._v(" "),t("p",[e._v("if (clientHeight + scrollTop >= scrollHeight) {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("console.log('最新的到底部了')\n\nisBottom.value = true\n")])])]),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("onActivated(() => {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("element = document.getElementById('content')\n\nwindow.addEventListener(\"scroll\", scrollListenerHandler, true)\n")])])]),t("p",[e._v("})")]),e._v(" "),t("p",[e._v("onDeactivated(() => {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('window.removeEventListener("scroll", scrollListenerHandler, true)\n')])])]),t("p",[e._v("})")]),e._v(" "),t("p",[e._v("return { isBottom }")]),e._v(" "),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("// 使用方法：")]),e._v(" "),t("p",[e._v("const scrollListenerHandler = debounce(function() {")]),e._v(" "),t("p",[e._v('const element = document.querySelector(".page-index")')]),e._v(" "),t("p",[e._v("// console.log(element)")]),e._v(" "),t("p",[e._v("if (!element) {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("return\n")])])]),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("const { clientHeight, scrollTop, scrollHeight } = element")]),e._v(" "),t("p",[e._v("// 只能纵向滑动加载 且上次接口返回不为空的场景")]),e._v(" "),t("p",[e._v("if (Math.abs(lastScroll.value - scrollTop) == 0) return false")]),e._v(" "),t("p",[e._v('console.log("可滑动", lastScroll)')]),e._v(" "),t("p",[e._v("if (clientHeight + scrollTop >= scrollHeight) {")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('console.log("到底了")\n\ntempData.value = typeFetch(tabList.value\\[currentIndex.value\\].type)\n\nlastScroll.value = scrollTop\n\n// tableData.value.push(...temp)\n\n// assignTableData(temp.value)\n')])])]),t("p",[e._v("}")]),e._v(" "),t("p",[e._v("}, 200)")]),e._v(" "),t("p",[e._v("onMounted(() => {")]),e._v(" "),t("p",[e._v('window.addEventListener("scroll", scrollListenerHandler, true)')]),e._v(" "),t("p",[e._v("})")])])}),[],!1,null,null,null);t.default=v.exports}}]);